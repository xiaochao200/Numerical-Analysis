## 第一章、绪论

### 1.1 数值计算的误差

#### 1.1.1 误差来源和分类

- 近似解与精确解之间的误差称为**截断误差**或**方法误差**

  $\color{Green}{Example}.$

  - 用Taylor多项式

  $$
  P_{n}(x)=f(0)+\frac{f'(0)}{1!}+\frac{f''(0)}{2!}+\cdots++\frac{f^{n}(0)}{n!}
  $$
     	近似代替可微函数f(x)，则数值方法的截断误差为
  $$
  R_{n}(x)=f(x)-P_{n}(x)=\frac{f^{n+1}(\xi)}{(n+1)!}x^{n+1},\quad \xi在0到x之间
  $$

- 计算机在计算过程中产生的误差称为**舍入误差**
  
  $\color{Green}{Example}.$
  
  - $\frac{1}{n}$在当n趋于无穷大时，计算机会把它当作0，产生舍入误差
  - 计算机十进制转二进制产生的误差，分析初始数据的误差，都是舍入误差

#### 1.1.2 误差与有效数字

$\color{Red}{Definition}~{1.}$ 设$x$为准确值，$x^{*}$为$x$的一个近似值，称
$$
e^{*}=x^{*}-x
$$
为近似值的**绝对误差**，简称**误差**

- 当$e^{*}$>0，称为强近似值；当$e^{*}>0$，称为弱近似值

- 误差绝对值的上界，即
  $$
  |e^{*}|=|x^{*}-x|\le\varepsilon^{*}
  $$
  则$\varepsilon^{*}$叫做近似值的**误差限**

- $|x^{*}-x|\le\varepsilon^{*}$，即$x^{*}-\varepsilon^{*}\le x\le x^{*}+\varepsilon^{*}$，也可以表示为$x=x^{*}\pm \varepsilon^{*}$

- 误差限并不能完全表示近似值的好坏，因为单位原因，误差和误差限**有量纲**

$\color{Red}{Definition}~{2.}$ 我们称
$$
\frac{e^{*}}{x}=\frac{x^{*}-x}{x}
$$
为近似值$x^{*}$的**相对误差**，记作$e_{r}^{*}$

- 由于实际计算$x$是未知的，一般用$x^{*}$代替，取

$$
\frac{e^{*}}{x^{*}}=\frac{x^{*}-x}{x^{*}}
$$

​		作为$x^{*}$的相对误差，条件是$e_{r}^{*}=\frac{e^{*}}{x^{*}}$较小，则有
$$
\frac{e^{*}}{x}-\frac{e^{*}}{x^{*}}=\frac{({e_{r}^{*}})^{2}}{1-{e_{r}^{*}}}
$$

- 相对误差的绝对值的上界，即
  $$
  \varepsilon_{r}^{*}=\frac{\varepsilon^{*}}{|x^{*}|}
  $$
  称为**相对误差限**

- 相对误差和相对误差限都**有量纲**

$\color{Red}{Definition}~{3.}$ 若近似值$x^{*}$的误差限是某一位的半个单位，该位到$x^{*}$第一个非零数字共有n位，就说$x^{*}$有n位**有效数字**，表示为
$$
x^{*}=\pm10^{m}\times(a_{1}+a_{2}\times10^{-1}+\cdots+a_{n}\times10^{-(n-1)}).\qquad(2.1)
$$
其中$a_{i}(i=1,\cdots,n)$是0到9中的一个数字，$a_{1}≠0$，m是整数，而且
$$
|x-x^{*}|\le\frac{1}{2}\times10^{m-n+1}.\qquad (2.2)
$$
$\color{Green}{Example}.$

$\pi=3.14159265\cdots$，$x^{*}$=3.1416，则$|\pi-x^{*}|\le\frac{1}{2}\times10^{-4}$，则$x^{*}$有五位有效数字

$\color{Cyan}{Theorem ~1.}$ 设近似数$x^{*}$表示为
$$
x^{*}=\pm10^{m}\times(a_{1}+a_{2}\times10^{-1}+\cdots+a_{n}\times10^{-(l-1)}).\qquad(2.1)'
$$
其中$a_{i}(i=1,\cdots,l)$是0到9中的一个数字，$a_{1}≠0$，m是整数，若$x^{*}$具有n位有效数字，则相对误差限为
$$
\varepsilon_{r}^{*}\le\frac{1}{2a_{1}}\times10^{-(n-1)};
$$
反之，若$x^{*}$的相对误差限$\varepsilon_{r}^{*}\le\frac{1}{2(a_{1}+1)}\times10^{-(n-1)};$，则$x^{*}$至少具有n位有效数字

> 由(2.1)、(2.2)和$\varepsilon_{r}^{*}=\frac{\varepsilon^{*}}{|x^{*}|}$即可推出
>
> Theorem 1. 说明有效位数越多，相对误差限越小

#### 1.1.3 数值运算的误差估计

  ##### 函数

$x$的近似值$x^{*}$，以$f(x^{*})$近似$f(x)$，则
$$
|f(x)-f(x^{*})|=\varepsilon(f(x^{*}))\approx|f'(x^{*})|\varepsilon(x^{*})
$$
对于多元$A=f(x_{1},x_{2},\cdots,x_{n})$，其中$x_{1},x_{2},\cdots,x_{n}$的近似值为$x_{1}^{*},x_{2}^{*},\cdots,x_{n}^{*}$，则$A$的近似值$A^{*}=f(x_{1}^{*},x_{2}^{*},\cdots,x_{n}^{*})$，则
$$
\varepsilon(A^{*})\approx\sum_{k=1}^n \bigg|(\frac{\partial{f}}{\partial{x_{k}}})^{*}\bigg|\varepsilon(x_{k}^{*})
$$

##### 四则

两个近似数$x_{1}^{*}$、$x_{2}^{*}$的误差限是$\varepsilon({x_{1}^{*}})$、$\varepsilon({x_{2}^{*}})$，则有
$$
\varepsilon({x_{1}^{*}}\pm x_{2}^{*})=\varepsilon({x_{1}^{*}})+\varepsilon(x_{2}^{*})\\
\varepsilon({x_{1}^{*}} x_{2}^{*})\approx|x_{1}^{*}|\varepsilon(x_{2}^{*})+|x_{2}^{*}|\varepsilon(x_{1}^{*})\\
\varepsilon(\frac{x_{1}^{*}}{x_{2}^{*}})\approx\frac{|x_{1}^{*}|\varepsilon(x_{2}^{*})+|x_{2}^{*}|\varepsilon(x_{1}^{*})}{(x_{2}^{*})^2}
$$

### 1.2 误差定性分析与避免误差危害

#### 1.2.1 算法数值的稳定性

$\color{Red}{Definition}~{4.}$ 一个算法如果输入数据有误差，而在计算过程中舍入误差不增长，则称此算法是**数值稳定**的

$\color{Green}{Example}.$
$$
I_{n}=e^{-1}\int_{0}^{{1}}{x^{n}e^{x}dx}\qquad(n=0,1,\cdots)
$$

#### 1.2.2 病态问题与条件数

$\color{Red}{Definition}~{5.}$ 如果输入数据有微小扰动（即误差），引起输出数据（即问题解）相对误差很大，则是病态问题

$\color{Green}{Example}.$

​	计算$f(x)$时，若$x$有扰动$\Delta{x}=x-x^{*}$，其相对误差为$\frac{\Delta{x}}{x}$，则函数值$f(x^{*})$的相对误差为$\frac{f(x)-f(x^{*})}{f(x)}$，则两个相对误差比值为
$$
\bigg|\frac{f(x)-f(x^{*})}{f(x)}\bigg|\bigg/\bigg|\frac{\Delta{x}}{x}\bigg|\approx \bigg|\frac{xf'(x)}{f(x)}\bigg|=C_{p}
$$
$C_{p}$称为计算函数值问题的**条件数**

- 如果条件数很大，引起函数值相对误差很大，则为病态问题

- 一般，条件数$\color{Orange}C_{p}\ge10$就认为是病态

#### 1.2.3 避免误差危害的若干原则

- 避免除数绝对值远远小于被除数绝对值的除法
- 避免两个相近数相减
- 防止大数吃掉小数
- 注意简化计算步骤，减少运算次数

### 1.3 数值计算中算法设计

#### 1.3.1 秦九韶算法

#### 1.3.2 迭代法

#### 1.3.3 复合梯形

![](.\pictures\复合梯形.png)将该大矩阵的计算公式用于每个小区间

计算$I=\int_{a}^{{b}}f(x)dx$的梯形公式，将区间分割为$a=x_{0}<x_{1}<\cdots x_{n}=b$，其中
$$
x_{i}=a+ih，h=\frac{b-a}{n}
$$
对每个小区间$[x_{i-1},x_{i}](i=1,2,\cdots,n)$用梯形公式计算，求和得
$$
\color{Red}{I(f)\approx\sum_{i=1}^n\frac{h}{2}[f(x_{i-1})+f(x_{i})]}
$$

#### 1.3.4 松弛技术 

$$
T_{1}=\frac{b-a}{2}[f(a)+f(b)],\\
T_{2}=\frac{b-a}{4}[f(a)+2f(c)+f(b)],\quad c=\frac{a+b}{2}.
$$

计算1.3.3中的$I(f)$可令
$$
S_{1}=T_{2}+\omega(T_{2}-T_{1})\approx(1+\omega)T_{2}-\omega T_{1}
$$
若取$\omega=1/3$，则得**辛普森公式**，比1.3.3精度高
$$
S_{1}=\frac{4}{3}T_{2}-\frac{1}{3}T_{1}=\frac{b-a}{6}[f(a)+4f(c)+f(b)].
$$